<style>
  #gameCard{
      max-width: 50%;
  }
  @media screen and (max-width: 950px){
      #gameCard{
          max-width: 100%;
      }
  }

  @media screen and (max-width: 576px){
      .gameImage{
          width: 100%;
      }
      
      #gameCard{ 
          max-width: 100%;
      }
  }
  
</style>





<% if (loggedIn) { %>
  <%- include ('./templates/header.ejs', {"name": name}) %>
<% } else { %>
<%- include ('./templates/headerloggedout.ejs') %>
<% } %>
  <div class="container">
    <h1>
      <%= game.title %>
    </h1>
    <img src="<%= gameImage %>" alt="placeholder" class = "gameImage"/>
    
    <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="pills-description-tab" data-bs-toggle="pill"
          data-bs-target="#pills-description" type="button" role="tab" aria-controls="pills-description"
          aria-selected="true">Summary</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="pills-reviews-tab" data-bs-toggle="pill" data-bs-target="#pills-reviews"
          type="button" role="tab" aria-controls="pills-reviews" aria-selected="false">Reviews</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="pills-stats-tab" data-bs-toggle="pill" data-bs-target="#pills-stats" type="button"
          role="tab" aria-controls="pills-stat" aria-selected="false">Stats</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="pills-similar-games-tab" data-bs-toggle="pill" data-bs-target="#pills-similar-games"
          type="button" role="tab" aria-controls="pills-similar-games" aria-selected="false">Similar Games</button>
      </li>
      <li class="nav-item" role="presentation">
        <form action="/saveGame" method="post">
          <input type="hidden" name="game" value="<%= game._id %>"></input>
          <input type="hidden" name="gameImage" value="<%= gameImage %>"></input>
          <button class="nav-link" id="pills-save-tab" name="purpose" value="<% if (saved) { %>
            unsave
            <% } else { %>save<% } %>" data-bs-toggle="pill" data-bs-target="#pills-contact" type="submit" role="tab"
            aria-controls="pills-contact" aria-selected="false">
            <% if (saved) { %>
              Unsave
              <% } else { %>Save<% } %>
          </button>
        </form>
      </li>

      <li class="nav-item" role="presentation">
        <form action="/saveToPlayed" method="post">
          <input type="hidden" name="game" value="<%= game._id %>"></input>
          <input type="hidden" name="gameImage" value="<%= gameImage %>"></input>
          <button class="nav-link" id="pills-save-tab" name="purpose" value="<% if (inHistory) { %>
            unmark
            <% } else { %>mark<% } %>" data-bs-toggle="pill" data-bs-target="#pills-contact" type="submit" role="tab"
            aria-controls="pills-contact" aria-selected="false">
            <% if (inHistory) { %>
              Unmark As Played
              <% } else { %>Mark as Played<% } %>
          </button>
        </form>
      </li>
    </ul>
    <div class="tab-content container" id="pills-tabContent">
      <div class="tab-pane fade show active" id="pills-description" role="tabpanel"
        aria-labelledby="pills-description-tab" tabindex="0">
        <div class="card container" style="margin-bottom: 10px;">
          <h3>Summary</h3>
          <%= game.summary %>
        </div>
        <div class="card container" style="margin-bottom: 10px;">
          <h3>Rating</h3>
          <%= game.rating %>
        </div>
        <div class="card container" style="margin-bottom: 10px;">
          <h3>Developers</h3>
          <%= game.team %>
        </div>

        <div class="card container" style="margin-bottom: 10px;">
          <h3>Genres</h3>
          <%= game.genres %>
        </div>
      </div>


      <div class="tab-pane fade" id="pills-reviews" role="tabpanel" aria-labelledby="pills-reviews-tab" tabindex="0">
        <% game.reviews.forEach(function(review){ %>
          <div class="card container" style="margin-bottom: 10px;">
            <%= review.replace(/\\n/g, "" ).replace(/\\/g, "" ) %>
          </div>
          <% }) %>
      </div>

      <div class="tab-pane fade" id="pills-stats" role="tabpanel" aria-labelledby="pills-stats-tab" tabindex="0">
        <div class="card container" style="margin-bottom: 10px;">
          <h3>Plays</h3>
          <%= game.plays %> people have played this game.
        </div>
        <div class="card container" style="margin-bottom: 10px;">
          <h3>Playing</h3>
          <%= game.playing %> people are playing this game now.
        </div>
        <div class="card container" style="margin-bottom: 10px;">
          <h3>Backlogs</h3>
          <%= game.backlogs %> people have this game in their backlog.
        </div>
        <div class="card container" style="margin-bottom: 10px;">
          <h3>Wishlist</h3>
          <%= game.wishlist %> people have this game on their wishlist.
        </div>
      </div>

      
      
      <div class="tab-pane fade" id="pills-similar-games" role="tabpanel" aria-labelledby="pills-similar-games-tab" tabindex="0">
        <div class ="row">
        <% for (const game of similarGames) { %>
          <div class="card" id = gameCard>
            <div class="row g-0">
                <div class="col-sm row-">
                    <img src="
                        <%= game.cover %>
                        " class="img-fluid rounded-start gameImage" alt="Tears of the Kingdom">
                </div>
                <div class="col-sm row-">
                     <div class="card-body">
                        <h5 class="card-title"><%= game.title %></h5>
                        <p class="card-text"><%= game.summary %></p>
                        <form method="post" action="/gameInformation">
                            <input type="hidden" name="gameID" value="<%= game._id %>">
                            <input type ="hidden" name="gameImage" value="<%= game.cover %>">
                            <button type="submit" class="btn btn-primary">See more information</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <% } %>
      </div>



      </div>

    </div>

  </div>

  <%- include ('./templates/footer.ejs') %>